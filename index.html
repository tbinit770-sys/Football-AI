<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arena IQ-Your live football analyst</title>
    <meta name="description" content="Live Football Analyst — analyze matches using AI-driven real-time data, get predictions, stats and match reports." />
    <meta name="keywords" content="football, soccer, AI, analytics, live match, predictions, stats" />
    <meta name="author" content="tbinit770-sys" />

    <!-- Open Graph / Social Preview -->
    <meta property="og:title" content="Arena IQ-Your live football analyst" />
    <meta property="og:description" content="Analyze matches in real-time with AI-driven insights, stats and predictions." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://tbinit770-sys.github.io/AI/" />
    <meta property="og:image" content="https://tbinit770-sys.github.io/AI/og-image.png" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Live Football Analyst — AI Football Insights" />
    <meta name="twitter:description" content="Analyze matches in real-time with AI-driven insights, stats and predictions." />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0d1117; color: #c9d1d9; }
    </style>

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Live Football Analyst",
        "url": "https://tbinit770-sys.github.io/AI/",
        "description": "Analyze matches in real-time with AI-driven insights, stats and predictions."
    }
    </script>
</head>
<body class="min-h-screen p-4 md:p-8 flex flex-col items-center">

    <div class="w-full max-w-2xl">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-blue-400 mb-2">Live Football Analyst</h1>
            <p class="text-gray-400 text-sm">Analysis using real-time web data via Google Search Grounding.</p>
        </header>

        <div class="bg-[#161b22] p-6 rounded-xl shadow-2xl mb-8 border border-gray-700">
            <textarea id="query-input" class="w-full h-24 p-3 bg-[#0d1117] text-white rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300 resize-none" placeholder="e.g., Analyze the current form of Inter Milan in Serie A and their next three fixtures."></textarea>
            <button id="analyze-button" onclick="performAnalysis()" class="mt-4 w-full px-6 py-3 text-lg font-semibold rounded-lg bg-blue-600 hover:bg-blue-700 text-white transition duration-300 transform hover:scale-[1.01] focus:outline-none focus:ring-4 focus:ring-blue-500 focus:ring-opacity-50 shadow-lg shadow-blue-500/50">Analyze</button>
        </div>

        <div class="bg-[#161b22] p-6 rounded-xl shadow-2xl border border-gray-700">
            <h2 class="text-xl font-semibold mb-4 text-blue-400">Analysis Report</h2>
            <div id="report-output" class="min-h-[150px] p-4 bg-[#0d1117] rounded-lg border border-gray-600 text-sm whitespace-pre-wrap">Ready for analysis. Enter a query and click 'Analyze' to begin.</div>
            <div id="sources-output" class="mt-4 text-xs text-gray-500"></div>
        </div>
    </div>

    <script type="module">
        const apiKey = "AIzaSyBBDxPo1ZNng4nKdlZAZDpravYnqzngO0c";
        const apiUrl = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent';
        const queryInput = document.getElementById('query-input');
        const analyzeButton = document.getElementById('analyze-button');
        const reportOutput = document.getElementById('report-output');
        const sourcesOutput = document.getElementById('sources-output');
        let isAnalyzing = false;

        function formatSources(attributions) {
            if (!attributions || attributions.length === 0) return '';
            const sources = attributions.map(attr => ({ uri: attr.web?.uri, title: attr.web?.title })).filter(s => s.uri && s.title);
            const uniqueSources = Array.from(new Set(sources.map(s => s.uri))).map(uri => sources.find(s => s.uri === uri));
            const listItems = uniqueSources.map(s => `<li class="truncate"><a href="${s.uri}" target="_blank" class="text-blue-400 hover:text-blue-300 transition duration-150">${s.title}</a></li>`).join('');
            return listItems ? `<div class="mt-4 border-t border-gray-700 pt-3"><p class="font-semibold text-gray-400 mb-1">Sources:</p><ul class="list-disc list-inside space-y-1">${listItems}</ul></div>` : '';
        }

        async function fetchWithBackoff(fetcher, maxRetries = 5) {
            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetcher();
                    if (response.status === 429 && i < maxRetries - 1) {
                        const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                        continue;
                    }
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    return response;
                } catch (error) {
                    if (i === maxRetries - 1) throw error;
                }
            }
        }

        window.performAnalysis = async function() {
            if (isAnalyzing) return;
            isAnalyzing = true;
            const userQuery = queryInput.value.trim();
            if (!userQuery) { reportOutput.innerHTML = `<span class="text-yellow-400">Please enter a query before analyzing.</span>`; isAnalyzing = false; return; }
            analyzeButton.disabled = true; analyzeButton.innerHTML = 'Analyzing...';
            reportOutput.innerHTML = 'Analyzing latest real-time data... Please wait.';
            sourcesOutput.innerHTML = '';

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                tools: [{ google_search: {} }],
                systemInstruction: { parts: [{ text: "You are a world-class football analyst. Based on the real-time data provided by your tools, provide a concise and insightful report on the requested team's current form, recent results, and upcoming fixtures." }] }
            };

            const fetcher = () => fetch(`${apiUrl}?key=${apiKey}`, { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(payload) });

            try {
                const response = await fetchWithBackoff(fetcher);
                const result = await response.json();
                const candidate = result.candidates?.[0];

                if (candidate && candidate.content?.parts?.[0]?.text) {
                    reportOutput.innerHTML = candidate.content.parts[0].text;
                    const groundingMetadata = candidate.groundingMetadata;
                    if (groundingMetadata && groundingMetadata.groundingAttributions) {
                        sourcesOutput.innerHTML = formatSources(groundingMetadata.groundingAttributions);
                    }
                } else {
                    const errorDetails = result.error?.message || "An unknown error occurred during analysis.";
                    reportOutput.innerHTML = `<span class="text-red-400">Analysis Failed:</span> ${errorDetails}`;
                }
            } catch (error) {
                console.error("API Fetch Error:", error);
                reportOutput.innerHTML = `<span class="text-red-400">Network Error:</span> Could not connect to the API. Please try again later.`;
            } finally {
                analyzeButton.disabled = false;
                analyzeButton.innerHTML = 'Analyze';
                isAnalyzing = false;
            }
        }
    </script>
</body>
</html>
